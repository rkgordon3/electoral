 <div class="center hero-unit" >

<div class='span14' >
  <div class="row-fluid">
    <div id="us-map" class='span10' style="width:600px;height: 400px"></div>
    <div class='span4' id="jCalTarget" ></div>
  </div>
</div>



  <script>
$('#jCalTarget').jCal({
	day:			new Date(2008, 8,1),
	days:			1,
	showMonths:		3,
	monthSelect:		false,
  scrollable:          false, 
	callback:		function (day, days) {
		// This is selected element, that is, a 'day' div 
			elem =$("#c" +$('.jCalMo').length + "d_" + (day.getMonth()+1) + "_" + day.getDate() + "_"+day.getFullYear());
		}
	});


    //$(function(){
    //  $('#us-map').vectorMap({map: 'us_aea_en'});
    //});

  $(function(){
  $.getJSON(<%= "\'#{maps_show_path}\'" %>, 
    function(data){
      var year = 2008;
        statesValues = jvm.values.apply({}, jvm.values(data.states)),
        metroPopValues = Array.prototype.concat.apply([], jvm.values(data.metro.population)),
        metroUnemplValues = Array.prototype.concat.apply([], jvm.values(data.metro.unemployment));
       

    $('#us-map').vectorMap({
      map: 'us_aea_en',
      backgroundColor: '#707070',
      series: {
       
        regions: [{
          scale: ['#DEEBF7', '#08519C'],
          attribute: 'fill',
          values: data.states[year],
          min: jvm.min(statesValues),
          max: jvm.max(statesValues)
        }]
      },
      onMarkerLabelShow: function(event, label, index){
        label.html(
          ''+data.metro.names[index]+'<br/>'+
          'Population: '+data.metro.population[year][index]+'<br/>'+
          'Unemployment rate: '+data.metro.unemployment[year][index]
        );
      },
      onRegionLabelShow: function(event, label, state_code){
        vps = data.voting_profiles[state_code];
        str = "";

       for (i = 0; i  < vps.length; i++) {
         str += vps[i].name + ": " + vps[i].votes + "<br/>";
       }
       
        label.html(
          ''+label.html()+'<br/>'+
          'Electoral Votes: '+data.electoral_votes[state_code] + "<br/>" 
           + str
        );
      }
    });

    var mapObject = $('#us-map').vectorMap('get', 'mapObject');
    /*
    $("#slider").slider({
      value: year,
      min: 2005,
      max: 2009,
      step: 1,
      slide: function( event, ui ) {
        year = ui.value;
        mapObject.series.regions[0].setValues(data.states[ui.value]);
        mapObject.series.markers[0].setValues(data.metro.unemployment[ui.value]);
        mapObject.series.markers[1].setValues(data.metro.population[ui.value]);
      }
    });

    */
    $(function() {
        $.getJSON(<%= "\'#{events_path}\'" %>, 
            function(data) { 
             
              for (i = 0; i < data.length; i++) {
                dateId = '#c3d_' + data[i].month + '_' + data[i].date + '_' + data[i].year;
                //alert($(dateId));
                $(dateId).addClass('eventDate'); 
              }
        });
      });
   
  });
});


    </script>
